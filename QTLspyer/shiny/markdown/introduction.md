The goal of this tool is to simplify the use of **whole genome sequencing** (WGS) data based on the **bulked segregant analysis** (BSA) method for detection of **quantitative trait loci** (QTL).
The QTL detection process in QTLspyer is divided into two steps. In the first step a Python script is used to call **single nucleotide polymorphisms** (SNPs) between the sequenced data and the reference genome in a **variant call format** (VCF). Sequence data quality reports are generated by **FastQC**, reads are trimmed with **BBduk** and the reads are mapped to the reference by **BWA**. Variant calling is done with the **Genome Analysis Toolkit** (GATK). In the second step the probabilities of potential QTL findings are estimated. The significance is estimated based on the **G'** and **QTL-seq** approach using a R library called `QTLseqr`.
To increase the ease of use and portability, QTLspyer is fully contained inside a **Docker** image and can be run on any operating system with Docker support. The user is not required to manually install any software involved in a QTL analysis.

The data generated in the container is directly linked to the local files. The final and all the intermediate data generated by the pipeline tools can be found locally and will not be deleted even after closing the app or docker container. Locally edited data will be transferred onto the container. The app has the following folder structure:


    QTLspyer                            # Root project folder                   
    ├── shiny                           # Code for the R shiny application
    ├── variant_calling                 # Python scripts for variant calling pipeline
    ├── log                             # Process status reports and standard outputs from tools
    ├── input
    │   ├── adapters                    # Expects adapters for sequence trimming (.fasta)
    │   ├── annotation                  # Expects genome annotation (.gtf)
    │   ├── references                  # Expects genome references (.fasta & .vcf)
    │   └── sample_data                 # Expects sample read sequences (.fastq)
    └── output
        ├── aligned                     # Sequence alignment files location (.bam)
        ├── fastqc                      # FastQC Quality reports location (.html & .zip)
        ├── trimmed                     # Trimmed read sequences location (.fasqc)
        └── GATK                        # GATK tools for variant calling output location
            ├── VCFs                    # Germline Variant called files and their indexes (.vcf & .tbi)
            ├── nonfiltered             # SNPs selected out of variants and their indexes (.vcf & .idx)
            └── tables                  # VCF files transformed to tables (.snps.table)


QTL estimation is performed using the `.table` files found in `QTLspyer/output/GATK/tables/`. Those files can be removed or placed inside the folder as pleased.  

The _variant calling pipeline_ and _QTL estimations_ are standalone processes and can be performed separately with no repetition, being that the output files already exist.
